### 5.1 Raft 基础

一个 Raft 集群包括若干服务器；对于一个典型的5服务器集群，该集群能够容忍2台机器不能正常工作，而整个系统保持正常。在任意的时间，每一个服务器一定会处于以下三种状态中的一个：Leader、Candidate、Follower。在正常情况下，只有一个服务器是Leader，剩下的服务器是Follower。Follower是被动的：它们不会发送任何请求，只是响应来自Leader和Candidate的请求。Leader来处理所有来自客户端的请求（如果一个客户端与Follower进行通信，Follower会将信息发送Leader）。Candidate 是用来选取一个新的 Leader 的，这一部分会在 5.2 节进行阐释。图-4 阐述了这些状态，以及它们之间的转换；它们的转换会在下边进行讨论。

![](/assets/Figure-4-Server-states.png)

图-4：服务器的状态。Follower 只响应其他服务器的请求。如果 Follower 没有收到任何消息，它会成为一个 Candidate 并且开始一次选举。收到大多数服务器投票的 Candidate 会成为新的 Leader。Leader 在它们宕机之前会一直保持 Leader 的状态。

![](/assets/Figure-5-Terms.png)

图-5：时间被分为一个个的任期（Term），每一个任期的开始都是 Leader 选举。在成功选举之后，一个 Leader 会在任期内管理整个集群。如果选举失败，该任期就会因为没有 Leader 而结束。这个转变会在不同的时间的不同服务器上观察到。

如 图-5 所示，Raft 算法将时间划分成为任意不同长度的任期（Term）。任期用连续的数字进行表示。每一个任期的开始都是一次选举（Election），就像 5.2 节所描述的那样，一个或多个 Candidate 会试图成为 Leader。如果一个 Candidate 赢得了选举，它就会在该任期的剩余时间担任 Leader。在某些情况下，选票会被瓜分，有可能没有选出 Leader，那么，将会开始另一个任期，并且立刻开始下一次选举。Raft 算法保证在给定的一个任期最少要有一个 Leader。



